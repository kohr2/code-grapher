       IDENTIFICATION DIVISION.
       PROGRAM-ID. VASU-FRAUD-MANAGEMENT.
       AUTHOR. SYSTEM-DEVELOPER.
       DATE-WRITTEN. 2024-01-15.
       DATE-COMPILED. 2024-01-15.
       SECURITY. CONFIDENTIAL.

       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-MAINFRAME.
       OBJECT-COMPUTER. IBM-MAINFRAME.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT FRAUD-FILE ASSIGN TO 'FRAUD.DAT'.
           SELECT REPORT-FILE ASSIGN TO 'REPORT.OUT'.

       DATA DIVISION.
       FILE SECTION.
       FD  FRAUD-FILE
           LABEL RECORDS ARE STANDARD
           RECORDING MODE IS F.
       01  FRAUD-RECORD.
           05  ACCOUNT-NUMBER      PIC X(10).
           05  TRANSACTION-TYPE    PIC X(2).
           05  AMOUNT              PIC 9(8)V99.
           05  TRANSACTION-DATE    PIC X(8).
           05  FRAUD-FLAG          PIC X(1).

       WORKING-STORAGE SECTION.
       01  WS-CONTROL-FIELDS.
           05  WS-EOF-FLAG         PIC X(1) VALUE 'N'.
           05  WS-RECORD-COUNT     PIC 9(6) VALUE ZERO.
           05  WS-FRAUD-COUNT      PIC 9(6) VALUE ZERO.
           05  WS-TOTAL-AMOUNT     PIC 9(10)V99 VALUE ZERO.
       01  WS-FRAUD-THRESHOLD      PIC 9(8)V99 VALUE 10000.00.
       01  WS-CURRENT-DATE        PIC X(8).
       01  WS-CURRENT-TIME        PIC X(6).

       PROCEDURE DIVISION.
       1000-MAIN-CONTROL.
           PERFORM 1100-INITIALIZE-PROGRAM
           PERFORM 1200-PROCESS-FRAUD-FILE
           PERFORM 1300-GENERATE-REPORTS
           PERFORM 1400-CLOSE-FILES
           STOP RUN.

       1100-INITIALIZE-PROGRAM SECTION.
       1100-OPEN-FILES.
           OPEN INPUT FRAUD-FILE
           OPEN OUTPUT REPORT-FILE
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CURRENT-DATE
           MOVE FUNCTION CURRENT-DATE(9:6) TO WS-CURRENT-TIME
           DISPLAY 'FRAUD MANAGEMENT SYSTEM INITIALIZED'
           DISPLAY 'DATE: ' WS-CURRENT-DATE
           DISPLAY 'TIME: ' WS-CURRENT-TIME.

       1200-PROCESS-FRAUD-FILE SECTION.
       1200-READ-FRAUD-RECORDS.
           READ FRAUD-FILE
               AT END MOVE 'Y' TO WS-EOF-FLAG
           END-READ
           IF WS-EOF-FLAG = 'N'
               ADD 1 TO WS-RECORD-COUNT
               PERFORM 1210-ANALYZE-TRANSACTION
               GO TO 1200-READ-FRAUD-RECORDS
           END-IF.

       1210-ANALYZE-TRANSACTION.
           IF AMOUNT > WS-FRAUD-THRESHOLD
               MOVE 'Y' TO FRAUD-FLAG
               ADD 1 TO WS-FRAUD-COUNT
               ADD AMOUNT TO WS-TOTAL-AMOUNT
               PERFORM 1220-LOG-FRAUD-ALERT
           ELSE
               MOVE 'N' TO FRAUD-FLAG
           END-IF.

       1220-LOG-FRAUD-ALERT.
           WRITE FRAUD-RECORD FROM FRAUD-RECORD
           DISPLAY 'FRAUD ALERT: ACCOUNT ' ACCOUNT-NUMBER
           DISPLAY 'AMOUNT: ' AMOUNT
           DISPLAY 'DATE: ' TRANSACTION-DATE.

       1300-GENERATE-REPORTS SECTION.
       1300-PRINT-SUMMARY.
           WRITE REPORT-FILE FROM WS-CONTROL-FIELDS
           DISPLAY 'TOTAL RECORDS PROCESSED: ' WS-RECORD-COUNT
           DISPLAY 'FRAUD CASES DETECTED: ' WS-FRAUD-COUNT
           DISPLAY 'TOTAL FRAUD AMOUNT: ' WS-TOTAL-AMOUNT.

       1400-CLOSE-FILES SECTION.
       1400-CLOSE-ALL-FILES.
           CLOSE FRAUD-FILE
           CLOSE REPORT-FILE
           DISPLAY 'FRAUD MANAGEMENT SYSTEM COMPLETED'.