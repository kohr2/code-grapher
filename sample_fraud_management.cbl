000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. FRAUD-MANAGEMENT.
000300 AUTHOR. SYSTEM.
000400 DATE-WRITTEN. 2024-01-01.
000500
000600 ENVIRONMENT DIVISION.
000700 CONFIGURATION SECTION.
000800 SOURCE-COMPUTER. IBM-370.
000900 OBJECT-COMPUTER. IBM-370.
001000 INPUT-OUTPUT SECTION.
001100 FILE-CONTROL.
001200     SELECT FRAUD-FILE ASSIGN TO FRAUD01.
001300     SELECT REPORT-FILE ASSIGN TO REPORT01.
001400
001500 DATA DIVISION.
001600 FILE SECTION.
001700 FD  FRAUD-FILE
001800     LABEL RECORDS ARE STANDARD.
001900 01  FRAUD-RECORD.
002000     05  CUSTOMER-ID        PIC X(10).
002100     05  TRANSACTION-AMT    PIC 9(10)V99.
002200     05  TRANSACTION-DATE   PIC X(10).
002300     05  RISK-SCORE         PIC 9(3).
002400
002500 WORKING-STORAGE SECTION.
002600 01  WS-COUNTERS.
002700     05  WS-RECORD-COUNT    PIC 9(6) VALUE ZERO.
002800     05  WS-FRAUD-COUNT     PIC 9(6) VALUE ZERO.
002900 01  WS-FLAGS.
003000     05  WS-EOF-FLAG        PIC X VALUE 'N'.
003100         88  WS-EOF          VALUE 'Y'.
003200
003300 PROCEDURE DIVISION.
003400 1000-MAIN-PROCESSING.
003500     PERFORM 1100-OPEN-FILES
003600     PERFORM 1200-PROCESS-RECORDS
003700     PERFORM 1300-CLOSE-FILES
003800     PERFORM 1400-GENERATE-REPORT
003900     STOP RUN.
004000
004100 1100-OPEN-FILES.
004200     OPEN INPUT FRAUD-FILE
004300     OPEN OUTPUT REPORT-FILE
004400     DISPLAY 'FILES OPENED SUCCESSFULLY'.
004500
004600 1200-PROCESS-RECORDS.
004700     READ FRAUD-FILE
004800         AT END SET WS-EOF TO TRUE
004900     END-READ
005000     PERFORM UNTIL WS-EOF
005100         ADD 1 TO WS-RECORD-COUNT
005200         PERFORM 1210-CHECK-FRAUD
005300         READ FRAUD-FILE
005400             AT END SET WS-EOF TO TRUE
005500         END-READ
005600     END-PERFORM.
005700
005800 1210-CHECK-FRAUD.
005900     IF RISK-SCORE > 800
006000         ADD 1 TO WS-FRAUD-COUNT
006100         MOVE 'HIGH RISK' TO WS-RISK-STATUS
006200     ELSE
006300         MOVE 'LOW RISK' TO WS-RISK-STATUS
006400     END-IF.
006500
006600 1300-CLOSE-FILES.
006700     CLOSE FRAUD-FILE
006800     CLOSE REPORT-FILE
006900     DISPLAY 'FILES CLOSED SUCCESSFULLY'.
007000
007100 1400-GENERATE-REPORT.
007200     DISPLAY 'TOTAL RECORDS PROCESSED: ' WS-RECORD-COUNT
007300     DISPLAY 'FRAUD CASES DETECTED: ' WS-FRAUD-COUNT.
