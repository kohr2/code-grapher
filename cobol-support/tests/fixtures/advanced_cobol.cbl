       IDENTIFICATION DIVISION.
       PROGRAM-ID. ADVANCED-COBOL-DEMO.
       AUTHOR. CODE-GRAPHER-TEST.
       DATE-WRITTEN. 2025-01-27.
       
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-3090.
       OBJECT-COMPUTER. IBM-3090.
       
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       
       COPY BANKING-COPYBOOK REPLACING ACCOUNT BY CUSTOMER
                                    BALANCE BY AMOUNT.
       
       COPY ERROR-HANDLING REPLACING ERROR-CODE BY ERR-CODE.
       
       01  WS-ACCOUNT-DATA.
           05  WS-ACCOUNT-NUMBER    PIC X(10).
           05  WS-ACCOUNT-TYPE      PIC X(2).
           05  WS-ACCOUNT-BALANCE  PIC 9(10)V99.
       
       COMMUNICATION SECTION.
       CD  ACCOUNT-QUEUE FOR INITIAL INPUT
           SYMBOLIC QUEUE WS-ACCOUNT-QUEUE
           SYMBOLIC DESTINATION WS-ACCOUNT-DEST.
       
       CD  TRANSACTION-QUEUE FOR OUTPUT
           SYMBOLIC QUEUE WS-TRANS-QUEUE
           SYMBOLIC DESTINATION WS-TRANS-DEST.
       
       SCREEN SECTION.
       01  MAIN-MENU-SCREEN.
           05  VALUE "BANKING SYSTEM MAIN MENU" LINE 1 COL 1.
           05  VALUE "1. DEPOSIT" LINE 3 COL 5.
           05  VALUE "2. WITHDRAWAL" LINE 4 COL 5.
           05  VALUE "3. TRANSFER" LINE 5 COL 5.
           05  VALUE "4. EXIT" LINE 6 COL 5.
           05  WS-MENU-CHOICE PIC X(1) LINE 8 COL 10
               FROM WS-MENU-DATA TO WS-MENU-DATA.
       
       01  ACCOUNT-ENTRY-SCREEN.
           05  VALUE "ENTER ACCOUNT NUMBER:" LINE 1 COL 1.
           05  WS-ACCOUNT-NUMBER PIC X(10) LINE 1 COL 25
               FROM WS-ACCOUNT-NUMBER TO WS-ACCOUNT-NUMBER.
       
       PROCEDURE DIVISION.
       
       MAIN-PROCESSING SECTION.
       
       0000-MAIN-LOGIC.
           PERFORM 1000-INITIALIZE
           PERFORM 2000-PROCESS-MENU
           PERFORM 3000-CALL-SUBPROGRAMS
           PERFORM 9000-CLEANUP
           GOBACK.
       
       1000-INITIALIZE.
           MOVE SPACES TO WS-ACCOUNT-DATA
           MOVE 'N' TO WS-VALID-ACCOUNT.
       
       2000-PROCESS-MENU.
           DISPLAY MAIN-MENU-SCREEN
           ACCEPT MAIN-MENU-SCREEN
           EVALUATE WS-MENU-CHOICE
               WHEN '1' PERFORM 2100-DEPOSIT-PROCESS
               WHEN '2' PERFORM 2200-WITHDRAWAL-PROCESS
               WHEN '3' PERFORM 2300-TRANSFER-PROCESS
               WHEN '4' PERFORM 2400-EXIT-PROCESS
           END-EVALUATE.
       
       2100-DEPOSIT-PROCESS.
           DISPLAY ACCOUNT-ENTRY-SCREEN
           ACCEPT ACCOUNT-ENTRY-SCREEN
           PERFORM 2500-VALIDATE-ACCOUNT.
       
       2200-WITHDRAWAL-PROCESS.
           DISPLAY ACCOUNT-ENTRY-SCREEN
           ACCEPT ACCOUNT-ENTRY-SCREEN
           PERFORM 2500-VALIDATE-ACCOUNT.
       
       2300-TRANSFER-PROCESS.
           DISPLAY ACCOUNT-ENTRY-SCREEN
           ACCEPT ACCOUNT-ENTRY-SCREEN
           PERFORM 2500-VALIDATE-ACCOUNT.
       
       2400-EXIT-PROCESS.
           MOVE 'EXIT' TO WS-MENU-CHOICE.
       
       2500-VALIDATE-ACCOUNT.
           IF WS-ACCOUNT-NUMBER IS NUMERIC
               MOVE 'Y' TO WS-VALID-ACCOUNT
           ELSE
               MOVE 'N' TO WS-VALID-ACCOUNT
           END-IF.
       
       3000-CALL-SUBPROGRAMS.
           CALL 'INTEREST-CALCULATOR' USING BY REFERENCE WS-ACCOUNT-NUMBER
                                           BY REFERENCE WS-ACCOUNT-BALANCE
                                           GIVING WS-INTEREST-AMOUNT
           CALL 'ACCOUNT-VALIDATOR' USING BY VALUE WS-ACCOUNT-NUMBER
                                        GIVING WS-VALIDATION-CODE
           CALL 'REPORT-GENERATOR' USING BY REFERENCE WS-ACCOUNT-DATA
                                        BY REFERENCE WS-TRANSACTION-DATA
           CALL 'AUDIT-LOGGER' USING BY REFERENCE WS-ACCOUNT-NUMBER
                                   BY REFERENCE WS-TRANSACTION-DATA.
       
       9000-CLEANUP.
           IF WS-VALID-ACCOUNT = 'N'
               MOVE 'INVALID ACCOUNT' TO WS-ERROR-MESSAGE
           END-IF.
       
       END PROGRAM ADVANCED-COBOL-DEMO.
