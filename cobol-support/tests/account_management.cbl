       IDENTIFICATION DIVISION.
       PROGRAM-ID. ACCOUNT-MANAGEMENT.
       AUTHOR. CODE-GRAPHER-TEST.
       DATE-WRITTEN. 2025-01-27.
       SECURITY. BANKING-APPLICATION.

       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-370.
       OBJECT-COMPUTER. IBM-370.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  WS-ACCOUNT-DATA.
           05  WS-ACCOUNT-NUMBER     PIC X(10).
           05  WS-CUSTOMER-NAME      PIC X(30).
           05  WS-ACCOUNT-BALANCE    PIC S9(7)V99 COMP-3.
           05  WS-ACCOUNT-TYPE       PIC X(1).
               88  CHECKING-ACCOUNT   VALUE 'C'.
               88  SAVINGS-ACCOUNT    VALUE 'S'.
           05  WS-ACCOUNT-STATUS     PIC X(1).
               88  ACTIVE-ACCOUNT     VALUE 'A'.
               88  INACTIVE-ACCOUNT   VALUE 'I'.

       01  WS-TRANSACTION-DATA.
           05  WS-TRANSACTION-ID     PIC X(10).
           05  WS-TRANSACTION-TYPE   PIC X(1).
               88  DEPOSIT            VALUE 'D'.
               88  WITHDRAWAL         VALUE 'W'.
               88  TRANSFER           VALUE 'T'.
           05  WS-TRANSACTION-AMOUNT PIC S9(7)V99 COMP-3.
           05  WS-TRANSACTION-DATE   PIC X(8).

       01  WS-CONTROL-FIELDS.
           05  WS-EOF-FLAG           PIC X(1) VALUE 'N'.
               88  END-OF-FILE        VALUE 'Y'.
           05  WS-ERROR-FLAG         PIC X(1) VALUE 'N'.
               88  ERROR-OCCURRED     VALUE 'Y'.
           05  WS-RECORD-COUNT       PIC 9(6) VALUE ZERO.

       01  WS-CALCULATION-FIELDS.
           05  WS-NEW-BALANCE        PIC S9(7)V99 COMP-3.
           05  WS-INTEREST-RATE      PIC 9(3)V9999 COMP-3.
           05  WS-INTEREST-AMOUNT    PIC S9(7)V99 COMP-3.
           05  WS-MINIMUM-BALANCE    PIC S9(5)V99 COMP-3 VALUE 100.00.

       PROCEDURE DIVISION.
       0000-MAIN-PROGRAM.
           DISPLAY 'ACCOUNT MANAGEMENT SYSTEM STARTED'
           PERFORM 1000-INITIALIZE-PROGRAM
           PERFORM 2000-PROCESS-ACCOUNTS
           PERFORM 3000-CALCULATE-INTEREST
           PERFORM 4000-GENERATE-REPORTS
           PERFORM 9000-END-PROGRAM.

       1000-INITIALIZE-PROGRAM.
           DISPLAY 'INITIALIZING ACCOUNT MANAGEMENT SYSTEM'
           MOVE ZERO TO WS-RECORD-COUNT
           MOVE ZERO TO WS-ACCOUNT-BALANCE
           MOVE 'A' TO WS-ACCOUNT-STATUS
           DISPLAY 'INITIALIZATION COMPLETED'.

       2000-PROCESS-ACCOUNTS.
           DISPLAY 'PROCESSING ACCOUNT RECORDS'
           PERFORM 2100-READ-ACCOUNT-RECORD
           PERFORM UNTIL END-OF-FILE
               PERFORM 2200-VALIDATE-ACCOUNT
               IF NOT ERROR-OCCURRED
                   PERFORM 2300-UPDATE-ACCOUNT
               END-IF
               PERFORM 2100-READ-ACCOUNT-RECORD
           END-PERFORM
           DISPLAY 'ACCOUNT PROCESSING COMPLETED'.

       2100-READ-ACCOUNT-RECORD.
           MOVE '1234567890' TO WS-ACCOUNT-NUMBER
           MOVE 'JOHN DOE' TO WS-CUSTOMER-NAME
           MOVE 5000.00 TO WS-ACCOUNT-BALANCE
           MOVE 'C' TO WS-ACCOUNT-TYPE
           ADD 1 TO WS-RECORD-COUNT
           IF WS-RECORD-COUNT > 5
               SET END-OF-FILE TO TRUE
           END-IF.

       2200-VALIDATE-ACCOUNT.
           IF WS-ACCOUNT-NUMBER = SPACES
               DISPLAY 'ERROR: INVALID ACCOUNT NUMBER'
               SET ERROR-OCCURRED TO TRUE
           END-IF
           IF WS-CUSTOMER-NAME = SPACES
               DISPLAY 'ERROR: INVALID CUSTOMER NAME'
               SET ERROR-OCCURRED TO TRUE
           END-IF
           IF WS-ACCOUNT-BALANCE < ZERO
               DISPLAY 'ERROR: NEGATIVE ACCOUNT BALANCE'
               SET ERROR-OCCURRED TO TRUE
           END-IF
           IF NOT (CHECKING-ACCOUNT OR SAVINGS-ACCOUNT)
               DISPLAY 'ERROR: INVALID ACCOUNT TYPE'
               SET ERROR-OCCURRED TO TRUE
           END-IF.

       2300-UPDATE-ACCOUNT.
           DISPLAY 'UPDATING ACCOUNT: ' WS-ACCOUNT-NUMBER
           DISPLAY 'CUSTOMER: ' WS-CUSTOMER-NAME
           DISPLAY 'BALANCE: $' WS-ACCOUNT-BALANCE
           DISPLAY 'TYPE: ' WS-ACCOUNT-TYPE
           DISPLAY 'STATUS: ' WS-ACCOUNT-STATUS
           DISPLAY 'ACCOUNT UPDATED SUCCESSFULLY'.

       3000-CALCULATE-INTEREST.
           DISPLAY 'CALCULATING INTEREST FOR ACCOUNTS'
           MOVE 2.500 TO WS-INTEREST-RATE
           IF SAVINGS-ACCOUNT
               COMPUTE WS-INTEREST-AMOUNT = 
                   WS-ACCOUNT-BALANCE * WS-INTEREST-RATE / 100
               COMPUTE WS-NEW-BALANCE = 
                   WS-ACCOUNT-BALANCE + WS-INTEREST-AMOUNT
               DISPLAY 'INTEREST CALCULATED: $' WS-INTEREST-AMOUNT
               DISPLAY 'NEW BALANCE: $' WS-NEW-BALANCE
           ELSE
               DISPLAY 'NO INTEREST FOR CHECKING ACCOUNTS'
           END-IF
           DISPLAY 'INTEREST CALCULATION COMPLETED'.

       4000-GENERATE-REPORTS.
           DISPLAY 'GENERATING ACCOUNT REPORTS'
           DISPLAY '========================================'
           DISPLAY 'ACCOUNT MANAGEMENT REPORT'
           DISPLAY '========================================'
           DISPLAY 'TOTAL RECORDS PROCESSED: ' WS-RECORD-COUNT
           DISPLAY 'ACCOUNT NUMBER: ' WS-ACCOUNT-NUMBER
           DISPLAY 'CUSTOMER NAME: ' WS-CUSTOMER-NAME
           DISPLAY 'ACCOUNT BALANCE: $' WS-ACCOUNT-BALANCE
           DISPLAY 'ACCOUNT TYPE: ' WS-ACCOUNT-TYPE
           DISPLAY 'ACCOUNT STATUS: ' WS-ACCOUNT-STATUS
           DISPLAY '========================================'
           DISPLAY 'REPORT GENERATION COMPLETED'.

       9000-END-PROGRAM.
           DISPLAY 'ACCOUNT MANAGEMENT SYSTEM ENDED'
           STOP RUN.
